This example is inspired by the one in Chapter 18 of "Real World OCaml".